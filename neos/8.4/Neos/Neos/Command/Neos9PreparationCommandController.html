<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="robots" content="index, follow, all" />
    <title>Neos\Neos\Command\Neos9PreparationCommandController | Neos CMS</title>

            <link rel="stylesheet" type="text/css" href="../../../css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="../../../css/bootstrap-theme.min.css">
        <link rel="stylesheet" type="text/css" href="../../../css/doctum.css">
        <link rel="stylesheet" type="text/css" href="../../../fonts/doctum-font.css">
        <script src="../../../js/jquery-3.5.1.slim.min.js"></script>
        <script async defer src="../../../doctum.js"></script>
        <script async defer src="../../../js/bootstrap.min.js"></script>
        <script async defer src="../../../js/autocomplete.min.js"></script>
        <meta name="MobileOptimized" content="width">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
        <link rel="shortcut icon" href="https://www.neos.io/favicon-32x32.png" />
        <link rel="search"
          type="application/opensearchdescription+xml"
          href="https://neos.github.io/opensearch.xml"
          title="Neos CMS (8.4)" />
    </head>

    <body id="class" data-name="class:Neos_Neos_Command_Neos9PreparationCommandController" data-root-path="../../../" data-search-index-url="../../../doctum-search.json">
            <div id="content">
        <div id="left-column">
                <div id="control-panel">
                <div class="search-bar hidden" id="search-progress-bar-container">
            <div class="progress">
                <div class="progress-bar" role="progressbar" id="search-progress-bar"
                    aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
            </div>
        </div>
        <form id="search-form" action="../../../search.html">
            <span class="icon icon-search"></span>
            <input name="search"
                   id="doctum-search-auto-complete"
                   class="typeahead form-control"
                   type="search"
                   placeholder="Search"
                   spellcheck="false"
                   autocorrect="off"
                   autocomplete="off"
                   autocapitalize="off">
            <div class="auto-complete-results" id="auto-complete-results"></div>
        </form>
    </div>

                <div id="api-tree"></div>

        </div>
        <div id="right-column">
                <nav id="site-nav" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-elements">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../../../index.html">Neos CMS</a>
            </div>
            <div class="collapse navbar-collapse" id="navbar-elements">
                <ul class="nav navbar-nav">
                    <li><a href="../../../classes.html">Classes</a></li>
                    <li><a href="../../../namespaces.html">Namespaces</a></li>
                    <li><a href="../../../interfaces.html">Interfaces</a></li>
                    <li><a href="../../../traits.html">Traits</a></li>
                    <li><a href="../../../doc-index.html">Index</a></li>
                    <li><a href="../../../search.html">Search</a></li>
                </ul>
            </div>
        </div>
    </nav>

                        <div class="namespace-breadcrumbs">
            <ol class="breadcrumb">
                <li><span class="label label-default">class</span></li>
                        <li><a href="../../../Neos.html">Neos</a></li><li class="backslash">\</li><li><a href="../../../Neos/Neos.html">Neos</a></li><li class="backslash">\</li><li><a href="../../../Neos/Neos/Command.html">Command</a></li><li class="backslash">\</li><li>Neos9PreparationCommandController</li>
            </ol>
        </div>
                <div id="page-content">
    <div class="page-header">
        <h1>Neos9PreparationCommandController    
            </h1>
    </div>

    
    <p>        class
    <strong>Neos9PreparationCommandController</strong>        extends <abbr title="Neos\Flow\Cli\CommandController">CommandController</abbr>        (<a href="https://github.com/neos/neos-development-collection/blob/8.4/Neos.Neos/Classes/Command/Neos9PreparationCommandController.php">View source</a>)
</p>

        
    
        

            
        
    
            <h2>Properties</h2>

            <table class="table table-condensed">
                    <tr>
                <td class="type" id="property_packageManager">
                                        protected                                        
                                                                                
                                    </td>
                <td>$packageManager</td>
                <td class="last"></td>
                <td></td>
            </tr>
            </table>

    
            <h2>Methods</h2>

            <div class="container-fluid underlined">
                    <div class="row">
                <div class="col-md-2 type">
                    void
                </div>
                <div class="col-md-8">
                    <a href="#method_preAdjustFusionCommand">preAdjustFusionCommand</a>(string $packageKey, bool $force = false)
        
                                            <p><p>Pre-adjust EEL in Fusion code to the new Neos 9 API
to hopefully ease the migration when doing the actual Neos 9.0 update.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
            </div>


        <h2>Details</h2>

            <div id="method-details">
                    <div class="method-item">
                    <h3 id="method_preAdjustFusionCommand">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.4/Neos.Neos/Classes/Command/Neos9PreparationCommandController.php#L54">at line 54</a></div>
        <code>                    void
    <strong>preAdjustFusionCommand</strong>(string $packageKey, bool $force = false)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Pre-adjust EEL in Fusion code to the new Neos 9 API
to hopefully ease the migration when doing the actual Neos 9.0 update.</p></p>                <p><p>this is possible because Neos 8.4 provides the new Runtime API already</p>
<p>The context variables ${node}, documentNode and site continue to exist in Fusion but there are changes to their API in Fusion.</p>
<p>While most of the FlowQueries work as before, there are some adjustments that come with the new concepts that are introduced in Neos 9.</p>
<p>The most important changes are:</p>
<ul>
<li>Accessing properties of the node context via node.context.is no longer supported.
And modifying the node context via flowQuery q(node).context() is only partially supported.
The rendering mode (node.context.inBackend) is now moved to a separate variable that is independent of the node context.</li>
<li>Internal properties like _hidden and _name are no longer in use.</li>
<li>Cache Entry Identifiers are now a dedicated object and not any value.</li>
</ul>
<p>There are some adjustments with a caveat as they don't reflect the 8.3 behaviour 100%.</p>
<p>A few examples are:</p>
<ul>
<li><code>node.nodeType</code> always returned a NodeType and when removed the <code>Neos.Neos:FallbackNode</code>. In Neos 9.0 there exists no magic for the <code>Neos.Neos:FallbackNode</code> and thus the helper <code>Neos.Node.nodeType(node)</code> returns &quot;NULL&quot;.</li>
<li><code>node.context.currentRenderingMode</code> always returns the rendering mode based on the logged-in user - so when viewing the page logged in in the frontend the mode is still 'inPlaces' as in the backend -&gt; the new <code>renderingMode</code> reports &quot;frontend&quot; as expected for this case</li>
<li>the &quot;live&quot; rendering mode was renamed to &quot;frontend&quot; so the unlikely case of <code>node.context.currentRenderingMode == "live"</code> fails when migrated to <code>renderingMode.name</code></li>
<li><code>node.context.currentSite</code> is rewritten to <code>Neos.Site.findBySiteNode(site)</code> which makes the assumption of &quot;site&quot; being present and that &quot;currentSite&quot; is actually the current and was not tampered with</li>
<li>unlike <code>node.identifier</code> the <code>node.aggregateId</code> is now a value object in fusion, it is string-able and can be output directly but no direct strict comparison must be done <code>node.aggregateId == "some-id"</code> will not work. It has to be cast to string <code>String.toString(node.aggregateId)</code>.</li>
</ul></p>        
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>string</td>
                <td>$packageKey</td>
                <td><p>The key of the package to migrate</p></td>
            </tr>
                    <tr>
                <td>bool</td>
                <td>$force</td>
                <td><p>By default packages that are not under version control or contain local changes are skipped. With this flag set changes are applied anyways (changes are not committed if there are local changes though)</p></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>void</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
            </div>

    
</div><div id="footer">
        Generated by <a href="https://github.com/code-lts/doctum">Doctum, a API Documentation generator and fork of Sami</a>.            <br/>Learn more about the <a href="https://www.neos.io" rel="noreferrer noopener" target="_blank">Neos Content Application Platform</a> if you like!</div></div>
    </div>
    </body>

</html>
