<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="robots" content="index, follow, all" />
    <title>Neos\Fusion\Core\Cache\CacheSegmentParser | Neos CMS</title>

            <link rel="stylesheet" type="text/css" href="../../../../css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="../../../../css/bootstrap-theme.min.css">
        <link rel="stylesheet" type="text/css" href="../../../../css/doctum.css">
        <link rel="stylesheet" type="text/css" href="../../../../fonts/doctum-font.css">
        <script src="../../../../js/jquery-3.5.1.slim.min.js"></script>
        <script async defer src="../../../../doctum.js"></script>
        <script async defer src="../../../../js/bootstrap.min.js"></script>
        <script async defer src="../../../../js/autocomplete.min.js"></script>
        <meta name="MobileOptimized" content="width">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
        <link rel="shortcut icon" href="https://www.neos.io/favicon-32x32.png" />
        <link rel="search"
          type="application/opensearchdescription+xml"
          href="https://neos.github.io/opensearch.xml"
          title="Neos CMS (8.3)" />
    </head>

    <body id="class" data-name="class:Neos_Fusion_Core_Cache_CacheSegmentParser" data-root-path="../../../../" data-search-index-url="../../../../doctum-search.json">
            <div id="content">
        <div id="left-column">
                <div id="control-panel">
                <div class="search-bar hidden" id="search-progress-bar-container">
            <div class="progress">
                <div class="progress-bar" role="progressbar" id="search-progress-bar"
                    aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
            </div>
        </div>
        <form id="search-form" action="../../../../search.html">
            <span class="icon icon-search"></span>
            <input name="search"
                   id="doctum-search-auto-complete"
                   class="typeahead form-control"
                   type="search"
                   placeholder="Search"
                   spellcheck="false"
                   autocorrect="off"
                   autocomplete="off"
                   autocapitalize="off">
            <div class="auto-complete-results" id="auto-complete-results"></div>
        </form>
    </div>

                <div id="api-tree"></div>

        </div>
        <div id="right-column">
                <nav id="site-nav" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-elements">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../../../../index.html">Neos CMS</a>
            </div>
            <div class="collapse navbar-collapse" id="navbar-elements">
                <ul class="nav navbar-nav">
                    <li><a href="../../../../classes.html">Classes</a></li>
                    <li><a href="../../../../namespaces.html">Namespaces</a></li>
                    <li><a href="../../../../interfaces.html">Interfaces</a></li>
                    <li><a href="../../../../traits.html">Traits</a></li>
                    <li><a href="../../../../doc-index.html">Index</a></li>
                    <li><a href="../../../../search.html">Search</a></li>
                </ul>
            </div>
        </div>
    </nav>

                        <div class="namespace-breadcrumbs">
            <ol class="breadcrumb">
                <li><span class="label label-default">class</span></li>
                        <li><a href="../../../../Neos.html">Neos</a></li><li class="backslash">\</li><li><a href="../../../../Neos/Fusion.html">Fusion</a></li><li class="backslash">\</li><li><a href="../../../../Neos/Fusion/Core.html">Core</a></li><li class="backslash">\</li><li><a href="../../../../Neos/Fusion/Core/Cache.html">Cache</a></li><li class="backslash">\</li><li>CacheSegmentParser</li>
            </ol>
        </div>
                <div id="page-content">
    <div class="page-header">
        <h1>CacheSegmentParser    
            </h1>
    </div>

    
    <p>        class
    <strong>CacheSegmentParser</strong>        (<a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php">View source</a>)
</p>

        
    
        

            <div class="description">
            <p><p>A parser which extracts cache segments by searching for start and end markers in the given content.</p></p>                    </div>
            
        
    
            <h2>Properties</h2>

            <table class="table table-condensed">
                    <tr>
                <td class="type" id="property_randomCacheMarker">
                                        protected                                        string
                                                                                
                                    </td>
                <td>$randomCacheMarker</td>
                <td class="last"></td>
                <td></td>
            </tr>
                    <tr>
                <td class="type" id="property_randomCacheMarkerLength">
                                        protected                                        int
                                                                                
                                    </td>
                <td>$randomCacheMarkerLength</td>
                <td class="last"></td>
                <td></td>
            </tr>
                    <tr>
                <td class="type" id="property_output">
                                        protected                                        string
                                                                                
                                    </td>
                <td>$output</td>
                <td class="last"></td>
                <td></td>
            </tr>
                    <tr>
                <td class="type" id="property_outerSegmentContent">
                                        protected                                        string
                                                                                
                                    </td>
                <td>$outerSegmentContent</td>
                <td class="last"></td>
                <td></td>
            </tr>
                    <tr>
                <td class="type" id="property_cacheSegments">
                                        protected                                        array
                                                                                
                                    </td>
                <td>$cacheSegments</td>
                <td class="last"></td>
                <td></td>
            </tr>
                    <tr>
                <td class="type" id="property_uncachedPartCount">
                                        protected                                        int
                                                                                
                                    </td>
                <td>$uncachedPartCount</td>
                <td class="last"></td>
                <td></td>
            </tr>
                    <tr>
                <td class="type" id="property_content">
                                        protected                                        string
                                                                                
                                    </td>
                <td>$content</td>
                <td class="last"></td>
                <td></td>
            </tr>
            </table>

    
            <h2>Methods</h2>

            <div class="container-fluid underlined">
                    <div class="row">
                <div class="col-md-2 type">
                    
                </div>
                <div class="col-md-8">
                    <a href="#method___construct">__construct</a>(string $content, string $randomCacheMarker = &#039;&#039;)
        
                                            <p><p>Parses the given content and extracts segments by searching for start end end markers. Those segments can later
be retrieved via getCacheSegments() and stored in a cache.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    array
                </div>
                <div class="col-md-8">
                    <a href="#method_parseSegment">parseSegment</a>(int $currentPosition)
        
                                            <p><p>Parses a segment at current position diving down into nested segments.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    array
                </div>
                <div class="col-md-8">
                    <a href="#method_extractContentAndSubSegments">extractContentAndSubSegments</a>(int $currentPosition, array $segmentData)
        
                                            <p class="no-description">No description</p>
                                    </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    array
                </div>
                <div class="col-md-8">
                    <a href="#method_reduceSegmentDataToCacheRelevantInformation">reduceSegmentDataToCacheRelevantInformation</a>(array $segmentData)
        
                                            <p><p>Make sure that we keep only necessary information for caching and strip all internal segment data.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    string
                </div>
                <div class="col-md-8">
                    <a href="#method_extractContent">extractContent</a>(int $fromPosition, int|null $toPosition = null)
        
                                            <p class="no-description">No description</p>
                                    </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    int
                </div>
                <div class="col-md-8">
                    <a href="#method_calculateCurrentPosition">calculateCurrentPosition</a>(int $position)
        
                                            <p><p>Calculates a position assuming that the given position is a token followed by the random cache marker</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    int|false
                </div>
                <div class="col-md-8">
                    <a href="#method_calculateNextTokenPosition">calculateNextTokenPosition</a>(int $currentPosition, string $token)
        
                                            <p><p>Find the next position of the given token (one of the ContentCache::CACHE<em>SEGMENT</em>*_TOKEN constants) in the parsed content.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    string
                </div>
                <div class="col-md-8">
                    <a href="#method_getOutput">getOutput</a>()
        
                                            <p><p>Returns the fully intact content as originally given to extractRenderedSegments() but without the markers. This
content is suitable for being used as output for the user.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    array
                </div>
                <div class="col-md-8">
                    <a href="#method_getCacheSegments">getCacheSegments</a>()
        
                                            <p><p>Returns an array with extracted content segments, including the type (if they can be cached or not) and tags to
be used for their entries when the segments are stored in a persistent cache.</p></p>                </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    int
                </div>
                <div class="col-md-8">
                    <a href="#method_getUncachedPartCount">getUncachedPartCount</a>()
        
                                            <p class="no-description">No description</p>
                                    </div>
                <div class="col-md-2"></div>
            </div>
                    <div class="row">
                <div class="col-md-2 type">
                    string
                </div>
                <div class="col-md-8">
                    <a href="#method_getOuterSegmentContent">getOuterSegmentContent</a>()
        
                                            <p class="no-description">No description</p>
                                    </div>
                <div class="col-md-2"></div>
            </div>
            </div>


        <h2>Details</h2>

            <div id="method-details">
                    <div class="method-item">
                    <h3 id="method___construct">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L66">at line 66</a></div>
        <code>                    
    <strong>__construct</strong>(string $content, string $randomCacheMarker = &#039;&#039;)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Parses the given content and extracts segments by searching for start end end markers. Those segments can later
be retrieved via getCacheSegments() and stored in a cache.</p></p>                <p><p>This method also prepares a cleaned up output which can be retrieved later. See getOutput() for more information.</p></p>        
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>string</td>
                <td>$content</td>
                <td></td>
            </tr>
                    <tr>
                <td>string</td>
                <td>$randomCacheMarker</td>
                <td></td>
            </tr>
            </table>

            
            
                            <h4>Exceptions</h4>

                    <table class="table table-condensed">
                    <tr>
                <td><a href="../../../../Neos/Fusion/Exception.html"><abbr title="Neos\Fusion\Exception">Exception</abbr></a></td>
                <td></td>
            </tr>
            </table>

            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_parseSegment">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L114">at line 114</a></div>
        <code>            protected        array
    <strong>parseSegment</strong>(int $currentPosition)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Parses a segment at current position diving down into nested segments.</p></p>                <p><p>The returned segmentData array has the following keys:</p>
<ul>
<li>identifier -&gt; The identifier of this entry for cached segments (or the eval expression for everything else)</li>
<li>type -&gt; The type of segment (one of the ContentCache::SEGMENT<em>TYPE</em>* constants)</li>
<li>context -&gt; eventual context information saved for a cached segment (optional)</li>
<li>metadata -&gt; cache entry metadata like tags</li>
<li>content -&gt; the content of this segment including embed code for sub segments</li>
<li>cleanContent -&gt; the raw content without any cache references for this segment and all sub segments</li>
<li>embed -&gt; the placeholder content for this segment to be used in &quot;content&quot; of parent segments</li>
</ul></p>        
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>int</td>
                <td>$currentPosition</td>
                <td></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>array</td>
            <td></td>
        </tr>
    </table>

            
                            <h4>Exceptions</h4>

                    <table class="table table-condensed">
                    <tr>
                <td><a href="../../../../Neos/Fusion/Exception.html"><abbr title="Neos\Fusion\Exception">Exception</abbr></a></td>
                <td></td>
            </tr>
            </table>

            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_extractContentAndSubSegments">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L182">at line 182</a></div>
        <code>            protected        array
    <strong>extractContentAndSubSegments</strong>(int $currentPosition, array $segmentData)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p class="no-description">No description</p>
                    
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>int</td>
                <td>$currentPosition</td>
                <td></td>
            </tr>
                    <tr>
                <td>array</td>
                <td>$segmentData</td>
                <td></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>array</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_reduceSegmentDataToCacheRelevantInformation">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L226">at line 226</a></div>
        <code>            protected        array
    <strong>reduceSegmentDataToCacheRelevantInformation</strong>(array $segmentData)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Make sure that we keep only necessary information for caching and strip all internal segment data.</p></p>                        
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>array</td>
                <td>$segmentData</td>
                <td></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>array</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_extractContent">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L241">at line 241</a></div>
        <code>            protected        string
    <strong>extractContent</strong>(int $fromPosition, int|null $toPosition = null)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p class="no-description">No description</p>
                    
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>int</td>
                <td>$fromPosition</td>
                <td></td>
            </tr>
                    <tr>
                <td>int|null</td>
                <td>$toPosition</td>
                <td></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>string</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_calculateCurrentPosition">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L257">at line 257</a></div>
        <code>            protected        int
    <strong>calculateCurrentPosition</strong>(int $position)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Calculates a position assuming that the given position is a token followed by the random cache marker</p></p>                        
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>int</td>
                <td>$position</td>
                <td></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>int</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_calculateNextTokenPosition">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L269">at line 269</a></div>
        <code>            protected        int|false
    <strong>calculateNextTokenPosition</strong>(int $currentPosition, string $token)
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Find the next position of the given token (one of the ContentCache::CACHE<em>SEGMENT</em>*_TOKEN constants) in the parsed content.</p></p>                        
        </div>
        <div class="tags">
                            <h4>Parameters</h4>

                    <table class="table table-condensed">
                    <tr>
                <td>int</td>
                <td>$currentPosition</td>
                <td><p>The position to start searching from</p></td>
            </tr>
                    <tr>
                <td>string</td>
                <td>$token</td>
                <td><p>the token to search for (will internally be appeneded by the randomCacheMarker)</p></td>
            </tr>
            </table>

            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>int|false</td>
            <td><p>Position of the token or false if the token was not found</p></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_getOutput">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L280">at line 280</a></div>
        <code>                    string
    <strong>getOutput</strong>()
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Returns the fully intact content as originally given to extractRenderedSegments() but without the markers. This
content is suitable for being used as output for the user.</p></p>                        
        </div>
        <div class="tags">
            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>string</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_getCacheSegments">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L291">at line 291</a></div>
        <code>                    array
    <strong>getCacheSegments</strong>()
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p><p>Returns an array with extracted content segments, including the type (if they can be cached or not) and tags to
be used for their entries when the segments are stored in a persistent cache.</p></p>                        
        </div>
        <div class="tags">
            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>array</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_getUncachedPartCount">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L299">at line 299</a></div>
        <code>                    int
    <strong>getUncachedPartCount</strong>()
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p class="no-description">No description</p>
                    
        </div>
        <div class="tags">
            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>int</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
                    <div class="method-item">
                    <h3 id="method_getOuterSegmentContent">
        <div class="location"><a href="https://github.com/neos/neos-development-collection/blob/8.3/Neos.Fusion/Classes/Core/Cache/CacheSegmentParser.php#L307">at line 307</a></div>
        <code>                    string
    <strong>getOuterSegmentContent</strong>()
        </code>
    </h3>
    <div class="details">    
    
            

        <div class="method-description">
                            <p class="no-description">No description</p>
                    
        </div>
        <div class="tags">
            
                            <h4>Return Value</h4>

                    <table class="table table-condensed">
        <tr>
            <td>string</td>
            <td></td>
        </tr>
    </table>

            
            
            
                    </div>
    </div>

            </div>
            </div>

    
</div><div id="footer">
        Generated by <a href="https://github.com/code-lts/doctum">Doctum, a API Documentation generator and fork of Sami</a>.            <br/>Learn more about the <a href="https://www.neos.io" rel="noreferrer noopener" target="_blank">Neos Content Application Platform</a> if you like!</div></div>
    </div>
    </body>

</html>
